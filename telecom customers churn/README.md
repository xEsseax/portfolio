# Прогнозирование оттока клиентов телеком-провайдера

Проект является учебным и посвящён прогнозированию оттока клиентов для оператора связи.
Цель: спрогнозировать, планирует ли пользователь прекратить пользоваться услугами компании с целью дальнейшего удержания путём предложения таким клиентам промокодов и спец. условий. Для оценки качества модели будет использована метрика ROC-AUC, в качестве дополнительной - метрика f1. Также при выборе модели будет учитываться время обучения.

Использован следующий стек технологий:
- python: pandas, numpy
- визуализация: matplotlib, seaborn
- проверека на мультиколлинеарность: phik
- пайплайн, кросс-валидация, обучение моделей: библиотеки scikit-learn, CatBoost, LightGBM

  Репозиторий содержит следующие файлы:

| Файл | Описание |
| --- | --- |
|  [Тетрадь проекта](https://github.com/xEsseax/portfolio/blob/49bcf619e819ef66ae881157599fe184b46504f6/telecom%20customers%20churn/telecom.ipynb) | jupyter notebook проекта |
| [Отчёт по проекту](https://github.com/xEsseax/portfolio/blob/83ed21a4325439910cdf3d052e71a8073ada5ce8/telecom%20customers%20churn/YP_diploma_report.pdf) | Подробный pdf-отчёт, созданный с помощью системы вёрстки LaTeX |



В распоряжении четыре датасета:
- contract_new.csv — информация о договоре;
- personal_new.csv — персональные данные клиента;
- internet_new.csv — информация об интернет-услугах;
- phone_new.csv — информация об услугах телефонии.

Проведены предобработка, исследовательский анализ данных, составлены портреты лояльного и уходящего клиентов. Изучены корреляции признаков между собой и проверка на мультиколлинеарность. Полученные результаты учтены при добавлении новых признаков и подготовке данных к обучению моделей: кодирование, масштабирование, выбор метода борьбы с дисбалансом. На подготовденных данных проведено обучение моделей в пайплайне с кросс-валидацией. Рассмотрены следующие модели: логистическая регрессия, модель Ridge, SGD классификатор, LightGBM, модель случайного леса, градиентный бустинг, CatBoost. Проведена оптимизация гиперпараметров там, где это возможно, а также сравнение встроенного и пользовательского кодировщиков. Обучение проовдится на двух наборах признаков - такой выбор обусловлен корреляцией добавленных признаков (длительности контракта и года подписания догоовра) и невозможности их одновременного использования ввиду того, что это приведёт к утечке целевого признака. В результате в рамках проекта выбрана модель CatBoost на наборе признаков с годом подписания договора - в такой конфигурации достигается экстремум метрики. Однако, для долговременного коммерческого использования может быть выбран признак длительности контракта ввиду простоты интерпретации и использования. Выбранная модель построена на сокращённом наборе признаков после оценки важности.

Получившиеся результаты:
- ROC-AUC = 0.96
- f1-score = 0.89
- ROC-кривая демонстрирует, что модель хорошо справляется с разделением клиентов по категориям
- построена матрица ошибок: клиента, планирующего расторгнуть договор, модель пропустит с вероятностью в 2.5%.
Поскольку исходная цель состояла в прогнозировании клиентов, планирующих уйти, с целью предложения ему промокодов, выгодных предложений и тд - модель качественно решает поставленную задачу. Сравнение со случайной моделью демонстрирует высокое качество прогнозирования и целесообразность использования построенной модели.

